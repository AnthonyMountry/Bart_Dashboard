<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Home Dashboard</title>
        <link rel="icon" href="/img/favicon.ico" type="image/x-icon">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
        <link rel="stylesheet" href="/css/styles.css">
        <link rel="stylesheet" href="/css/dashboard_content.css">
        <script>
            // TODO(harry) this variable should be set using a server side template
            const BASE_URL = 'http://127.0.0.1:5000';
        </script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
    </head>

    <body>

        <section class = "sideMenu">
            <div class = "logo">
                <img src = "/public/img/trainImage.png">
            </div>
            <nav>
                <a href ="/" class = "active"><i class="fa fa-home" aria-hidden = "true"></i> Dashboard </a>
            <!---  <a href ="/Reports.html"><i class="fa fa-sticky-note-o" aria-hidden = "true"></i> Reports </a> -->
                <a href ="/analytics"><i class="fa fa-bar-chart" aria-hidden = "true"></i> Analytics</a>

            </nav>
        </section>

        <header>

            <div class = "search">
                <i class="fa fa-search" aria-hidden = "true"></i>
                <input type = "text" name = "" value = "">
            </div>

            <div class = "accountInfo">
                <a href = "#" class = "userName">Name</a>
                <a href = "#" class = "notifications"><i class="fa fa-bell-o" aria-hidden = "true"></i>
                    <span class = "notificationNum">
                        #
                    </span>
                </a>
            </div>
        </header>

        <section id = "dashContent">

            <div class = "topSection">
               <!-- <div class = "heading">
                    <h1>Dashboard</h1>
                </div>
                -->
                <div class = "firstTotal">
                    <span >Total Sales</span>
                        value
                </div>

                <div class = "secondTotal">
                    <span>Total Income</span>
                    value
                 </div>

            </div>

            <div class = "middleSection">
                    <div class = "dashChart1">
                        <span class = "title">
                            Asset Meter Readings
                        </span>
                        <canvas id="meterReadingsChart"></canvas>
                    </div>

                    <div class = "dashChart2">
                        <span class = "title">
                            Meter Status
                        </span>
                        <canvas id="assetStatusBarChart"></canvas>
                    </div>
            </div>

            <div class = "bottomSection">
                <button id="assetsToggle"><i class="fa fa-chevron-down" aria-hidden = "true"></i>Assets</button>
                <table class="assetsTable"
                  id="assetsTable"
                  style="width: 80%; text-align: left;">
                    <!-- API call results appended here -->
                </table>
            </div>
            </section>

        </body>
        <script src="/js/graph.js"></script>
        <script src="/js/asset.js"></script>
        <script>
            // render the testing graph when the pages loads
            window.onload = () => {
                const statusCtx = document
                    .getElementById("assetStatusBarChart")
                    .getContext("2d");
                listAssets().then((assets) => {
                    renderBarGraph(statusCtx, assets);
                })
                const meterCtx = document
                    .getElementById('meterReadingsChart')
                    .getContext('2d');
                window.myScatter = testGraph(meterCtx);
                let table = new AssetTable("assetsTable", -1);
                table.render();

                const assetsToggle = document.getElementById("assetsToggle");
                assetsToggle.addEventListener("click", (event) => {
                    table.toggle();
                });
            }
        </script>
    </div>
</html>
